// ==========================
// ðŸ“¦ CANDIDATE PROCESSING
// ==========================
function processNewCandidatesFromRows(...) { ... }

// ==========================
// ðŸ“¤ TEXT QUEUING & SENDING
// ==========================
function queueText(...) { ... }
function sendAllTexts(...) { ... }
function findSendTextRow(...) { ... }
function markTextedInGeorgeSheet(...) { ... }

// ==========================
// ðŸ§  LOGGING + HELPERS
// ==========================
function logError(...) { ... }
function logDetailedError(...) { ... }
function checkDailyDriverStats(...) { ... }


SendText - deletes row after sending text
sendRejectionText - adds the row, does checks then calls sendText



	â€¢	onFormSubmit(e) is enabled and uses the live handleFormSubmission logic
	
    sendText()
    â€¢	ensures row exists
    â€¢	sends the correct message and deletes the row after success
	
    sendRejectionText() checks:
	â€¢	Already sent?
	â€¢	In pipeline?
	â€¢	Not blacklisted?
	â€¢	Appends row correctly
	â€¢	Triggers sendText()




    /// need to make sure im updating candidate pipeline!!
    // pass text works when there is already one in pipeline
    // fail doesnt work
    


    // for texting - detect when a row gets added and delete it then



    CALENDLY
    1. Update code changes in VSCode
    2. clasp push (ensure this runs)
    3. update lastest deployment just to new version
    4. should work!





    1 lucid error
    2 updated failed statuses




    then i want to add them at the bottom of candidate pipeline to the right spot and delete from IBER SHEET






    TODO
    // get the dropdown for PENDING to populate for candidate pipeline
    //organize code some, to add more flags
    // function to take a row with errors = like no outreach, detect that and fix



    DEMO
    uploading, running prospects.testHandleNewProspects
    --> gets all the correct info into candidate pipeline (need to fix a few things like pending to be dropdown), sends text: reject, pass, blacklist
    ---> fills out form, also automates the text: reject, pass, blacklist


    2. STARTED on the scheduling stuff - the remit in particular but not done.

    3. more changes to master


processNewCandidatesOneAtATime()
â””â”€â”€ queues 1+ drivers â†’ groupedQueue
    â””â”€â”€ flushQueueOneAtATime()
        â”œâ”€â”€ writes to textGeorge
        â”œâ”€â”€ triggers send
        â”œâ”€â”€ waits for row to be deleted
        â””â”€â”€ processes next driver


appendToCandidatePipelineFromProspects(rows)
â†’ processNewCandidatesFromRows()
   â†’ addToGroupedQueue()
â†’ flushQueueOneAtATime()
   â†’ flushSingleGroup()
   â†’ sendAllTexts()
   â†’ updateCandidateAfterText()
   


1. Paste Uber export into "Prospects" tab (manual)
2. Script reads and slices columns Pâ€“AA (appendToCandidatePipelineFromProspects)
3. Filters out rows missing Driver ID (col X)
4. Appends clean rows to Candidate Pipeline
5. Immediately calls processNewCandidatesFromRows â†’ Stage 1 begins 


doGet()
  â””â”€â”€ handleNewProspects()
        â”œâ”€â”€ gets driverIds
        â”œâ”€â”€ triggerGeorgeReport()
        â”œâ”€â”€ waitForDriverIDs()
        â”œâ”€â”€ appendToCandidatePipelineFromProspects()
              â”œâ”€â”€ slice Pâ€“AA
              â”œâ”€â”€ filter valid rows
              â”œâ”€â”€ insert into Candidate Pipeline
              â””â”€â”€ processNewCandidatesFromRows()
                    â”œâ”€â”€ handlePass / handleFail / handleBlacklisted
                    â””â”€â”€ flushQueueOneAtATime()


                processNewCandidatesFromRows()
                â”œâ”€â”€ For each row:
                â”‚     â”œâ”€â”€ Get driverId
                â”‚     â”œâ”€â”€ Get text from row
                â”‚     â”œâ”€â”€ Get convo name from row
                â”‚     â””â”€â”€ Add to deduped queue (by driverId)
                â””â”€â”€ Flush deduped queue to TEXT GEORGE

doPost(e)
  â”œâ”€â”€ parseCalendlyPayload()
  â”œâ”€â”€ checkDuplicates()
  â”œâ”€â”€ updateCandidateRowInterviewStatusByEmail(email, "created", startTime)
  â””â”€â”€ or updateCandidateRowInterviewStatusByEmail(email, "canceled")


  onFormSubmit(e)
  â””â”€â”€ handleFormSubmission(e)
        â”œâ”€â”€ Parse submitted row
        â”œâ”€â”€ Check if PASS (Q = 1) and valid ID (K = ID)
        â”œâ”€â”€ If FAIL or invalid ID:
        â”‚     â””â”€â”€ Find candidate row â†’ check for override
        â”‚           â””â”€â”€ if no override & no license: write rejection text to textGeorge
        â””â”€â”€ If PASS:
              â”œâ”€â”€ Check pipeline
              â”œâ”€â”€ Call appendMassTextRow() for interview/convo
              â””â”€â”€ (Previously sent directly â€” now queued)